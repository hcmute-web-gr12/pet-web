"use strict";var d=(e,t,n)=>new Promise((s,o)=>{var c=r=>{try{l(n.next(r))}catch(m){o(m)}},a=r=>{try{l(n.throw(r))}catch(m){o(m)}},l=r=>r.done?s(r.value):Promise.resolve(r.value).then(c,a);l((n=n.apply(e,t)).next())});var E=e=>{let t=s=>{s.stopPropagation(),s.stopImmediatePropagation(),s.preventDefault()};e.addEventListener("click",t,{capture:!0});let n=e.style.pointerEvents;return e.style.pointerEvents="none",()=>{e.removeEventListener("click",t,{capture:!0}),e.style.pointerEvents=n}};var u=(...e)=>{let t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg"),s=document.createElementNS(t,"circle"),o=document.createElementNS(t,"path");return n.classList.add("animate-spin","text-stone-100",...e),n.setAttribute("fill","none"),n.setAttribute("viewBox","0 0 24 24"),s.classList.add("opacity-25"),s.setAttribute("cx","12"),s.setAttribute("cy","12"),s.setAttribute("r","10"),s.setAttribute("stroke","currentColor"),s.setAttribute("stroke-width","4"),o.classList.add("opacity-75"),o.setAttribute("d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),o.setAttribute("fill","currentColor"),n.append(s,o),n};var h=(e,...t)=>{let n=u(...t);return e.prepend(n),console.log(n,e),()=>{n.remove()}};var p=!1,i={counter:0,shouldUpdate:!1};function k(e){return d(this,null,function*(){if(e.preventDefault(),p)return;p=!0;let t=document.getElementById("pet-dialog");if(t instanceof HTMLDialogElement){let n=document.getElementById("pet-add-submit"),s=h(n,"w-4","h-4","mr-2"),o=yield fetch(this.action,{method:"post",body:new FormData(this)});if(s(),p=!1,o.status===200){f(),t.close();return}let c=document.getElementById("pet-form-error");c&&(c.innerHTML=yield o.text())}})}function I(){let e=document.getElementById("pet-dialog");e instanceof HTMLDialogElement&&e.showModal()}function w(){let e=document.getElementById("pet-dialog");e instanceof HTMLDialogElement&&e.close()}function f(){return d(this,null,function*(){var s,o;let e=document.getElementById("pet-table");if(!(e instanceof HTMLTableElement))return;let t=E(e);e.classList.add("animate-pulse");let n=yield fetch("/api/admin/pet").then(c=>c.text());t(),(s=e.querySelector("tbody"))==null||s.remove(),(o=e.querySelector("tfoot"))==null||o.remove(),e.insertAdjacentHTML("beforeend",n),v(),setTimeout(()=>{e.classList.remove("animate-pulse")},100)})}function S(){let e=this.id.replace("pet-edit-",""),t=document.getElementById("pet-edit-dialog");!t||t.showModal()}function H(...e){return`/api/admin/pet?${e.map(t=>`index=${t}`).join("&")}`}function x(){return d(this,null,function*(){let e=this.id.replace("pet-delete-",""),t=this.innerHTML,n=u("w-5","h-5");this.replaceChildren(n),++i.counter;let s=(yield fetch(H(+e),{method:"delete"})).status;if(--i.counter,n.remove(),this.innerHTML=t,s===200){if(this.disabled=!0,i.shouldUpdate=!0,i.counter)return;i.shouldUpdate&&(i.shouldUpdate=!1,f())}})}function v(){for(let e of document.getElementsByClassName("pet-edit")||[])e.addEventListener("click",S);for(let e of document.getElementsByClassName("pet-delete")||[])e.addEventListener("click",x);for(let e of document.getElementsByClassName("pet-select")||[])e.addEventListener("input",C)}function B(){for(let e of document.getElementsByClassName("pet-select"))e.checked=this.checked}function C(){let e=document.getElementById("pet-select-all");e&&e.checked&&(this.checked||(e.checked=!1))}function A(){return d(this,null,function*(){let e=[],t=[];for(let[a,l]of Array.from(document.getElementsByClassName("pet-select")).entries())l.checked&&(t.push(document.getElementById(`pet-delete-${a}`)),e.push(a));if(!e.length)return;let n=H(...e),s=[],o=fetch(n,{method:"delete"});t.push(this);for(let a of t){s.push(a.innerHTML);let l=u("w-5","h-5");a.replaceChildren(l),a.disabled=!0}++i.counter;let c=(yield o).status;--i.counter;for(let[a,l]of t.entries())l.firstElementChild.remove(),l.innerHTML=s[a],l.disabled=!0;if(c===200){if(i.shouldUpdate=!0,i.counter)return;i.shouldUpdate&&(i.shouldUpdate=!1,f())}})}var g;(g=document.getElementById("pet-form"))==null||g.addEventListener("submit",k);var L;(L=document.getElementById("pet-add"))==null||L.addEventListener("pointerdown",I);var y;(y=document.getElementById("pet-form-back"))==null||y.addEventListener("pointerdown",w);var b;(b=document.getElementById("pet-select-all"))==null||b.addEventListener("input",B);var M;(M=document.getElementById("pet-select-all"))==null||M.addEventListener("input",B);var T;(T=document.getElementById("pet-delete-some"))==null||T.addEventListener("click",A);v();
