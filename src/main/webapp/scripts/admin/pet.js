"use strict";var u=(e,t,n)=>new Promise((s,o)=>{var l=d=>{try{c(n.next(d))}catch(r){o(r)}},i=d=>{try{c(n.throw(d))}catch(r){o(r)}},c=d=>d.done?s(d.value):Promise.resolve(d.value).then(l,i);c((n=n.apply(e,t)).next())});var g=e=>{let t=s=>{s.stopPropagation(),s.stopImmediatePropagation(),s.preventDefault()};e.addEventListener("click",t,{capture:!0});let n=e.style.pointerEvents;return e.style.pointerEvents="none",()=>{e.removeEventListener("click",t,{capture:!0}),e.style.pointerEvents=n}};var m=(...e)=>{let t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg"),s=document.createElementNS(t,"circle"),o=document.createElementNS(t,"path");return n.classList.add("animate-spin","text-stone-100",...e),n.setAttribute("fill","none"),n.setAttribute("viewBox","0 0 24 24"),s.classList.add("opacity-25"),s.setAttribute("cx","12"),s.setAttribute("cy","12"),s.setAttribute("r","10"),s.setAttribute("stroke","currentColor"),s.setAttribute("stroke-width","4"),o.classList.add("opacity-75"),o.setAttribute("d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),o.setAttribute("fill","currentColor"),n.append(s,o),n};var L=(e,...t)=>{let n=m(...t);return e.prepend(n),console.log(n,e),()=>{n.remove()}};var p=!1,a={counter:0,shouldUpdate:!1},f={editing:!1,shouldUpdate:!1};function k(e){return u(this,null,function*(){if(e.preventDefault(),p)return;p=!0;let t=document.getElementById("pet-dialog");if(t instanceof HTMLDialogElement){let n=document.getElementById("pet-add-submit"),s=L(n,"w-4","h-4","mr-2"),o=yield fetch(this.action,{method:"post",body:new FormData(this)});if(s(),p=!1,o.status===200){E(),t.close();return}let l=document.getElementById("pet-form-error");l&&(l.innerHTML=yield o.text())}})}function w(){let e=document.getElementById("pet-dialog");e instanceof HTMLDialogElement&&e.showModal()}function x(){let e=document.getElementById("pet-dialog");e instanceof HTMLDialogElement&&e.close()}function E(){return u(this,null,function*(){var o,l;let e=document.getElementById("pet-table");if(!(e instanceof HTMLTableElement))return;let t=g(e);e.classList.add("animate-pulse");let n=yield fetch("/api/admin/pet").then(i=>i.text());t(),(o=e.querySelector("tbody"))==null||o.remove(),(l=e.querySelector("tfoot"))==null||l.remove(),e.insertAdjacentHTML("beforeend",n),v();let s=document.getElementById("pet-select-all");s&&(s.checked=!1),setTimeout(()=>{e.classList.remove("animate-pulse")},100)})}function S(){return u(this,null,function*(){if(f.editing)return;let e=document.getElementById("pet-edit-dialog");if(!e)return;let t=this.id.replace("pet-edit-",""),n=this.cloneNode();f.editing=!0,n.appendChild(m("w-5","h-5")),this.replaceWith(n);let s=yield fetch(h(+t));if(s.status===200){n.replaceWith(this),n.remove();let o=yield s.json();if(o){let l=document.getElementById("pet-edit-name"),i=document.getElementById("pet-edit-price"),c=document.getElementById("pet-edit-stock"),d=document.getElementById("pet-edit-image"),r=document.getElementById("pet-edit-description");l&&(l.value=o.name),i&&(i.value=o.price),c&&(c.value=o.stock),d&&(d.src=o.imagePublicId),r&&(r.value=o.description),e.showModal();return}}f.editing=!1})}function h(...e){return`/api/admin/pet?${e.map(t=>`index=${t}`).join("&")}`}function A(){return u(this,null,function*(){let e=this.id.replace("pet-delete-",""),t=this.cloneNode();t.append(m("w-5","h-5")),this.replaceWith(t),++a.counter;let n=(yield fetch(h(+e),{method:"delete"})).status;if(--a.counter,t.replaceWith(this),t.remove(),n===200){if(this.disabled=!0,a.shouldUpdate=!0,a.counter)return;a.shouldUpdate&&(a.shouldUpdate=!1,E())}})}function v(){for(let e of document.getElementsByClassName("pet-edit")||[])e.addEventListener("click",S);for(let e of document.getElementsByClassName("pet-delete")||[])e.addEventListener("click",A);for(let e of document.getElementsByClassName("pet-select")||[])e.addEventListener("input",C)}function I(){for(let e of document.getElementsByClassName("pet-select"))e.checked=this.checked}function C(){let e=document.getElementById("pet-select-all");e&&e.checked&&(this.checked||(e.checked=!1))}function N(){return u(this,null,function*(){let e=[],t=[];for(let[i,c]of Array.from(document.getElementsByClassName("pet-select")).entries())c.checked&&(t.push(document.getElementById(`pet-delete-${i}`)),e.push(i));if(!e.length)return;let n=h(...e),s=[],o=fetch(n,{method:"delete"});t.push(this);for(let i of t){let c=i.cloneNode();s.push(c),c.append(m("w-5","h-5")),i.replaceWith(c)}++a.counter;let l=(yield o).status;--a.counter;for(let[i,c]of t.entries())s[i].replaceWith(c),s[i].remove();if(l===200){if(a.shouldUpdate=!0,a.counter)return;a.shouldUpdate&&(a.shouldUpdate=!1,E())}})}var y;(y=document.getElementById("pet-form"))==null||y.addEventListener("submit",k);var b;(b=document.getElementById("pet-add"))==null||b.addEventListener("pointerdown",w);var T;(T=document.getElementById("pet-form-back"))==null||T.addEventListener("pointerdown",x);var M;(M=document.getElementById("pet-select-all"))==null||M.addEventListener("input",I);var B;(B=document.getElementById("pet-select-all"))==null||B.addEventListener("input",I);var H;(H=document.getElementById("pet-delete-some"))==null||H.addEventListener("click",N);v();
