"use strict";var l=(t,o,e)=>new Promise((n,s)=>{var a=i=>{try{c(e.next(i))}catch(d){s(d)}},y=i=>{try{c(e.throw(i))}catch(d){s(d)}},c=i=>i.done?n(i.value):Promise.resolve(i.value).then(a,y);c((e=e.apply(t,o)).next())});var p=t=>{let o=n=>{n.stopPropagation(),n.stopImmediatePropagation(),n.preventDefault()};t.addEventListener("click",o,{capture:!0});let e=t.style.pointerEvents;return t.style.pointerEvents="none",()=>{t.removeEventListener("click",o,{capture:!0}),t.style.pointerEvents=e}};var m=(...t)=>{let o="http://www.w3.org/2000/svg",e=document.createElementNS(o,"svg"),n=document.createElementNS(o,"circle"),s=document.createElementNS(o,"path");return e.classList.add("animate-spin","text-stone-100",...t),e.setAttribute("fill","none"),e.setAttribute("viewBox","0 0 24 24"),n.classList.add("opacity-25"),n.setAttribute("cx","12"),n.setAttribute("cy","12"),n.setAttribute("r","10"),n.setAttribute("stroke","currentColor"),n.setAttribute("stroke-width","4"),s.classList.add("opacity-75"),s.setAttribute("d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),s.setAttribute("fill","currentColor"),e.append(n,s),e};var E=(t,...o)=>{let e=m(...o);return t.prepend(e),console.log(e,t),()=>{e.remove()}};var u=!1,r={counter:0,shouldUpdate:!1};function v(t){return l(this,null,function*(){if(t.preventDefault(),u)return;u=!0;let o=document.getElementById("pet-dialog");if(o instanceof HTMLDialogElement){let e=document.getElementById("pet-add-submit"),n=E(e,"w-4","h-4","mr-2"),s=yield fetch(this.action,{method:"post",body:new FormData(this)});if(n(),u=!1,s.status===200){L(),o.close();return}let a=document.getElementById("pet-form-error");a&&(a.innerHTML=yield s.text())}})}function H(){let t=document.getElementById("pet-dialog");t instanceof HTMLDialogElement&&t.showModal()}function M(){let t=document.getElementById("pet-dialog");t instanceof HTMLDialogElement&&t.close()}function L(){return l(this,null,function*(){var n,s;let t=document.getElementById("pet-table");if(!(t instanceof HTMLTableElement))return;let o=p(t);t.classList.add("animate-pulse");let e=yield fetch("/api/admin/pet").then(a=>a.text());o(),(n=t.querySelector("tbody"))==null||n.remove(),(s=t.querySelector("tfoot"))==null||s.remove(),t.insertAdjacentHTML("beforeend",e),b(),setTimeout(()=>{t.classList.remove("animate-pulse")},100)})}function T(t){}function B(){return l(this,null,function*(){console.log(this);let t=this.id.replace("delete-pet-",""),o=this.innerHTML,e=m("w-5","h-5");this.replaceChildren(e),++r.counter;let n=(yield fetch(`/api/admin/pet?index=${t}`,{method:"delete"})).status;if(--r.counter,e.remove(),this.innerHTML=o,n===200){if(this.disabled=!0,r.shouldUpdate=!0,r.counter)return;r.shouldUpdate&&(r.shouldUpdate=!1,L())}})}function b(){for(let t of document.getElementsByClassName("edit-pet")||[])t.addEventListener("click",T);for(let t of document.getElementsByClassName("delete-pet")||[])t.addEventListener("click",B)}var f;(f=document.getElementById("pet-form"))==null||f.addEventListener("submit",v);var h;(h=document.getElementById("pet-add"))==null||h.addEventListener("pointerdown",H);var g;(g=document.getElementById("pet-form-back"))==null||g.addEventListener("pointerdown",M);b();
